@page "/generator"
@using WoS_Gen
@using WoS_Gen.Models

<PageTitle>Schedule Generator</PageTitle>

<section class="banner-image">
    <HeroSection 
        Title="Start Generating Below" 
        Paragraph="
                Start with filling in your input, then click the button to generate and 
                see your personalized workout Schedule!
            "
        ButtonText="Generate Now!"
        Visible="false"     
    />
</section>

<section class="container w-50 p-4 my-5">
    <EditForm Model="user" OnInvalidSubmit="HandleSubmit">
        <div class="row mb-3">
            <label for="name" class="col-sm-2 col-form-label">Fullname:</label>
            <div class="col-sm-10">
                <InputText id="name" @bind-Value="user.Name" class="form-control" required></InputText>
            </div>
        </div>
        <div class="row mb-3">
            <label for="email" class="col-sm-2 col-form-label">Email:</label>
            <div class="col-sm-10">
                <InputText id="email" @bind-Value="user.Email" class="form-control" type="email" required></InputText>
            </div>
        </div>
        <div class="row mb-3">
            <label for="goal" class="col-sm-2 col-form-label">Goal:</label>
            <div class="col-sm-10 pt-2">
                <InputSelect required @bind-Value="user.WorkoutGoal">
                    <option value="">Choose your goal...</option>
                    <option value="LoseWeight">LoseWeight</option>
                    <option value="BuildMuscles">BuildMuscles</option>
                </InputSelect>
            </div>
        </div>
        <div class="row mb-3">
            <label for="location" class="col-sm-2 col-form-label">Location:</label>
            <div class="col-sm-10 pt-2">
                <InputSelect required @bind-Value="user.Location">
                    <option value="">Choose your location</option>
                    <option value="Gym">Gym</option>
                    <option value="Home">Home</option>
                </InputSelect>
            </div>
        </div>
        <div class="row mb-3">
            <label for="experience" class="col-sm-2 col-form-label">Experience:</label>
            <div class="col-sm-10 pt-2">
                <InputSelect required @bind-Value="user.Experience">
                    <option value="">Your experience</option>
                    <option value="Beginner">Beginner</option>
                    <option value="Novice">Novice</option>
                </InputSelect>
            </div>
        </div>
        <div class="d-flex flex-column justify-content-center">
            <button type="submit" @onclick="HandleSubmit" class="btn btn-primary">Create Schedule</button>
        </div>
    </EditForm>
</section>

@foreach (var user in users)
{
    <p>@user.Name</p>
    <p>@user.Email</p>
    <p>@user.WorkoutGoal</p>
    <p>@user.Location</p>
    @foreach (var workout in schedule.GeneratePlan(user.WorkoutGoal, user.Location, user.Experience))
    {
        <p>@workout</p>
    }
}


<section>
    <Schedule />
</section>

@code {
    static List<User> users = new List<User>();
    User user = new User("", "", "", "", "");
    WorkoutSchedule schedule = new WorkoutSchedule();

    private void HandleSubmit()
    {
        if (string.IsNullOrWhiteSpace(user.Name) || string.IsNullOrWhiteSpace(user.Email))
        {
            return;
        }
        else
        {
            User newUser = new User(user.Name, user.Email, user.WorkoutGoal, user.Location, user.Experience);
            users.Add(newUser);
            user = new User("", "", "", "", "");
        }
    }
}
